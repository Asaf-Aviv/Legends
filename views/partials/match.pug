section.row
    .col-12
        h3.text-center Active Game
        .text-center
            button#spectate.btn.btn-outline-success(
                data-id=match.gameId, data-region=match.platformId, data-key=match.observers.encryptionKey) Spectate
        #match-wrapper.row.justify-content-around
            table#blue-team
                each player in match.participants
                    if player.teamId == 100
                        tr
                            td: .player-profile-icon
                                img(src=`//ddragon.leagueoflegends.com/cdn/8.7.1/img/profileicon/${player.profileIconId}.png`)
                            td: .player-champ-icon: a(href=`/champions/${championIds[player.championId]}`)
                                img(src=`//ddragon.leagueoflegends.com/cdn/8.7.1/img/champion/${championIds[player.championId]}.png`)
                            td: a(href=`/summoner?userName=${player.summonerName}&region=${match.platformId}`): span= player.summonerName
                            td: .player-rune-icon
                                img(src=`/assets/league/img/runesReforged/perk/${player.perks.perkStyle}.png`)
                            td: .player-rune-icon
                                img(src=`/assets/league/img/runesReforged/perk/${player.perks.perkSubStyle}.png`)
                            td
                                each val, key in summonerSpells.data
                                    if (summonerSpells.data[key].key == player.spell1Id)
                                        .player-ss-icon
                                            img(src=`//ddragon.leagueoflegends.com/cdn/8.7.1/img/spell/${summonerSpells.data[key].image.full}`,
                                            data-toggle="tooltip", title=summonerSpells.data[key].description)
                            td
                                each val, key in summonerSpells.data
                                    if (summonerSpells.data[key].key == player.spell2Id)
                                        .player-ss-icon
                                            img(src=`//ddragon.leagueoflegends.com/cdn/8.7.1/img/spell/${summonerSpells.data[key].image.full}`,
                                            data-toggle="tooltip", title=summonerSpells.data[key].description)
            
            #match-clock= match.gameLength > 3599 ? new Date(1000 * match.gameLength).toISOString().substr(11, 8) : new Date(1000 * match.gameLength).toISOString().substr(14, 5)
            
            table#red-team
                each player in match.participants
                    if player.teamId == 200
                        tr
                            td: .player-profile-icon
                                img(src=`//ddragon.leagueoflegends.com/cdn/8.7.1/img/profileicon/${player.profileIconId}.png`)
                            td: .player-champ-icon: a(href=`/champions/${championIds[player.championId]}`)
                                img(src=`//ddragon.leagueoflegends.com/cdn/8.7.1/img/champion/${championIds[player.championId]}.png`)
                            td: a(href=`/summoner?userName=${player.summonerName}&region=${match.platformId}`): span= player.summonerName
                            td: .player-rune-icon
                                img(src=`/assets/league/img/runesReforged/perk/${player.perks.perkStyle}.png`)
                            td: .player-rune-icon
                                img(src=`/assets/league/img/runesReforged/perk/${player.perks.perkSubStyle}.png`)
                            td
                                each val, key in summonerSpells.data
                                    if (summonerSpells.data[key].key == player.spell1Id)
                                        .player-ss-icon
                                            img(src=`//ddragon.leagueoflegends.com/cdn/8.7.1/img/spell/${summonerSpells.data[key].image.full}`,
                                            data-toggle="tooltip", title=summonerSpells.data[key].description)
                            td
                                each val, key in summonerSpells.data
                                    if (summonerSpells.data[key].key == player.spell2Id)
                                        .player-ss-icon
                                            img(src=`//ddragon.leagueoflegends.com/cdn/8.7.1/img/spell/${summonerSpells.data[key].image.full}`,
                                            data-toggle="tooltip", title=summonerSpells.data[key].description)
script.
    window.onload = function() {
        setInterval(function() {
            incTimer();
        }, 1000);

        function incTimer() {
            time = $('#match-clock').text().split(':').reverse();
            time[0]++
            if (time[0] > 59) {
                time[0] = 0
                time[1]++
                if (time[1] > 59) {
                    time[1] = 0;
                    time[2] = 1;
                }
            }
            time = time.map(t => String(t).padStart(2, '0'))
            $('#match-clock').html(time.reverse().join(':'));
        }
    }